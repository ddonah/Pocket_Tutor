<!DOCTYPE html>
<html lang="en">
<head>
    <title>Quiz Page</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

    <div id="quiz">
        <h2>Quiz</h2>
        <div id="question"></div>
        <input type="text" id="answer">
        <button onclick="submitAnswer()">Submit</button>
    </div>
    
    <script>
        function displayQuestion(question, answer) {
            console.log("Answer:", answer); // Print the answer to console for testing
            document.getElementById("question").innerHTML = question;
            document.getElementById("answer").value = ""; 
            document.getElementById("quiz").dataset.correctAnswer = answer;
            MathJax.typeset(); // Typeset the math content
        }


        function submitAnswer() {
            var userAnswer = document.getElementById("answer").value;
            var correctAnswer = document.getElementById("quiz").dataset.correctAnswer;

            if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                alert("Correct!");
            } else {
                alert("Incorrect. Try again!");
            }

            storeAnswer(userAnswer, correctAnswer);
        }

function storeAnswer(userAnswer, correctAnswer) {
    var p = fetch('/store_answer', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            userAnswer: userAnswer,
            correctAnswer: correctAnswer
        })
    });
    
    p.then((response) => { 
        if (!response.ok) {
            throw new Error('Failed to store answer');
        }
        return response.text();
    }).then((text) => { 
        console.log('Answer stored');
    }).catch((error) => {
        console.error(error.message);
    });
}


        function getNextQuestion() {
            fetch('/next_question')
                .then(response => response.json())
                .then(data => {
                    if (data.question) {
                        displayQuestion(data.question, data.answer);
                    } else {
                        alert("No more questions");
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        window.onload = function() {
            getNextQuestion();
        };
    </script>
</body>
</html>
